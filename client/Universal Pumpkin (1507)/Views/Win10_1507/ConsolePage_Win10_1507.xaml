<page:ConsolePageBase
    x:Class="Universal_Pumpkin.Shared.Views.ConsolePage_Win10_1507"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:page="using:Universal_Pumpkin.Shared.Views"
    xmlns:local="using:Universal_Pumpkin.Models"
    xmlns:helpers="using:Universal_Pumpkin.Helpers"
    xmlns:helpers1="using:Universal_Pumpkin"
    mc:Ignorable="d"
    NavigationCacheMode="Required"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <helpers1:TimeFormatConverter x:Key="TimeFormatConverter"/>

        <DataTemplate x:Key="InfoTemplate"
                      x:DataType="local:LogEntry">
            <StackPanel Orientation="Horizontal"
                        Margin="0,0,8,0"
                        Holding="LogItem_Holding"
                        RightTapped="LogItem_RightTapped">

                <TextBlock Text="{x:Bind Timestamp, Converter={StaticResource TimeFormatConverter}}"
                           Foreground="Gray"
                           Margin="0,0,8,0"
                           FontFamily="Consolas"/>

                <TextBlock FontFamily="Consolas"
                           FontWeight="Bold"
                           Margin="0,0,8,0">
            <Run Text="{x:Bind Level}"/>
                </TextBlock>

                <TextBlock Text="{x:Bind Message}"
                           TextWrapping="WrapWholeWords"
                           FontFamily="Consolas"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="WarnTemplate"
                      x:DataType="local:LogEntry">
            <StackPanel Orientation="Horizontal"
                        Margin="0,0,8,0"
                        Holding="LogItem_Holding"
                        RightTapped="LogItem_RightTapped">

                <TextBlock Text="{x:Bind Timestamp, Converter={StaticResource TimeFormatConverter}}"
                           Foreground="Gray"
                           Margin="0,0,8,0"
                           FontFamily="Consolas"/>

                <TextBlock FontFamily="Consolas"
                           FontWeight="Bold"
                           Foreground="Yellow"
                           Margin="0,0,8,0">
            <Run Text="{x:Bind Level}"/>
                </TextBlock>

                <TextBlock Text="{x:Bind Message}"
                           TextWrapping="WrapWholeWords"
                           FontFamily="Consolas"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="ErrorTemplate"
                      x:DataType="local:LogEntry">
            <StackPanel Orientation="Horizontal"
                        Margin="0,0,8,0"
                        Holding="LogItem_Holding"
                        RightTapped="LogItem_RightTapped">

                <TextBlock Text="{x:Bind Timestamp, Converter={StaticResource TimeFormatConverter}}"
                           Foreground="Gray"
                           Margin="0,0,8,0"
                           FontFamily="Consolas"/>

                <TextBlock FontFamily="Consolas"
                           FontWeight="Bold"
                           Foreground="OrangeRed"
                           Margin="0,0,8,0">
            <Run Text="{x:Bind Level}"/>
                </TextBlock>

                <TextBlock Text="{x:Bind Message}"
                           TextWrapping="WrapWholeWords"
                           FontFamily="Consolas"/>
            </StackPanel>
        </DataTemplate>

        <helpers1:LogTemplateSelector x:Key="LogSelector"
                                      InfoTemplate="{StaticResource InfoTemplate}"
                                      WarnTemplate="{StaticResource WarnTemplate}"
                                      ErrorTemplate="{StaticResource ErrorTemplate}"/>

    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid x:Name="StatusGrid"
              Grid.Row="0"
              Margin="15,15,15,0"
              Visibility="Collapsed"
              Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
              BorderBrush="{ThemeResource SystemControlBackgroundAccentBrush}"
              BorderThickness="1"
              Padding="15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0"
                        VerticalAlignment="Center">
                <TextBlock Text="Server Address"
                           FontSize="10"
                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                <TextBlock x:Name="TxtIpAddress"
                           Text="127.0.0.1"
                           FontWeight="Bold"
                           FontSize="16"
                           IsTextSelectionEnabled="True"
                           Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
            </StackPanel>

            <StackPanel Grid.Column="1"
                        Margin="24,0,0,0"
                        VerticalAlignment="Center">
                <TextBlock Text="TPS"
                           FontSize="10"
                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                           HorizontalAlignment="Right"/>
                <TextBlock x:Name="TxtTPS"
                           Text="20.0"
                           FontWeight="Bold"
                           Foreground="#FF55FF55"
                           HorizontalAlignment="Right"/>
            </StackPanel>

            <StackPanel Grid.Column="2"
                        Margin="24,0,0,0"
                        VerticalAlignment="Center">
                <TextBlock Text="MSPT"
                           FontSize="10"
                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                           HorizontalAlignment="Right"/>
                <TextBlock x:Name="TxtMSPT"
                           Text="12.50ms"
                           FontWeight="Bold"
                           Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"
                           HorizontalAlignment="Right"/>
            </StackPanel>

            <StackPanel Grid.Column="3"
                        Margin="24,0,0,0"
                        VerticalAlignment="Center">
                <TextBlock Text="Mem"
                           FontSize="10"
                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                           HorizontalAlignment="Right"/>
                <TextBlock x:Name="TxtRAM"
                           Text="150 MB"
                           FontWeight="Bold"
                           Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"
                           HorizontalAlignment="Right"/>
            </StackPanel>
        </Grid>

        <TextBox x:Name="SearchBox"
                 Grid.Row="1"
                 PlaceholderText="Search logs..."
                 Visibility="Collapsed"
                 Margin="15,15,15,0"
                 TextChanged="SearchBox_TextChanged"/>

        <Grid Grid.Row="2"
              Margin="15"
              RightTapped="LogBackground_RightTapped"
              Holding="LogBackground_Holding">

            <ListView x:Name="LogList"
                      ItemsSource="{x:Bind _vm.LogItems}"
                      ItemTemplateSelector="{StaticResource LogSelector}"
                      SelectionMode="Extended"
                      ScrollViewer.VerticalScrollBarVisibility="Visible"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                      ScrollViewer.HorizontalScrollMode="Disabled"
                      ScrollViewer.IsHorizontalRailEnabled="False"
                      BorderBrush="{ThemeResource SystemControlBackgroundAccentBrush}"
                      BorderThickness="1"
                      KeyDown="LogList_KeyDown">

                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <ItemsStackPanel
                            Orientation="Vertical"
                            VirtualizingStackPanel.VirtualizationMode="Recycling"/>
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
            </ListView>

            <ProgressRing x:Name="LoadingSpinner"
                          IsActive="True"
                          Visibility="Collapsed"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Width="40"
                          Height="40"/>
        </Grid>

        <Grid Row="3"
              x:Name="CommandInputContainer"
              HorizontalAlignment="Stretch"
              Padding="15,0,15,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Grid Grid.Column="0"
                  VerticalAlignment="Center">

                <AutoSuggestBox x:Name="BoxCommand"
                                PlaceholderText="Enter server command..."
                                UpdateTextOnSelect="False"
                                TextChanged="BoxCommand_TextChanged"
                                QuerySubmitted="BoxCommand_QuerySubmitted"
                                SuggestionChosen="BoxCommand_SuggestionChosen"
                                KeyDown="BoxCommand_KeyDown"
                                GotFocus="BoxCommand_GotFocus"
                                LostFocus="BoxCommand_LostFocus"
                                HorizontalAlignment="Stretch"
                                Canvas.ZIndex="0"/>

                <TextBlock x:Name="GhostText"
                           Margin="12,-3,32,0"
                           VerticalAlignment="Center"
                           IsHitTestVisible="False"
                           FontSize="{ThemeResource ControlContentThemeFontSize}"
                           FontFamily="{ThemeResource ContentControlThemeFontFamily}"
                           TextWrapping="NoWrap"
                           Opacity="0.6"
                           Canvas.ZIndex="1"
                           Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
            </Grid>

            <Button x:Name="BtnSend"
                    Grid.Column="1"
                    Content="Send"
                    Margin="10,0,0,0"
                    VerticalAlignment="Stretch"
                    Click="BtnSend_Click"/>
        </Grid>
    </Grid>

    <Page.BottomAppBar>
        <CommandBar>

            <CommandBar.Content>
                <TextBlock x:Name="TxtStatus"
                           Text="Ready to Launch"
                           VerticalAlignment="Center"
                           Margin="14,14"/>
            </CommandBar.Content>

            <CommandBar.PrimaryCommands>
                <AppBarButton x:Name="BtnStart"
                              Label="Start Server"
                              Icon="Play"
                              Click="BtnStart_Click"/>
                <AppBarButton x:Name="BtnStop"
                              Label="Stop Server"
                              Icon="Stop"
                              Click="BtnStop_Click"
                              Visibility="Collapsed"/>
                <AppBarButton x:Name="BtnRestartApp"
                              Label="Restart App"
                              Icon="Refresh"
                              Click="BtnRestartApp_Click"
                              Visibility="Collapsed"/>
                <AppBarButton x:Name="ResumeAutoScrollButton"
                              Icon="DockBottom"
                              Label="Resume Auto-Scroll"
                              Visibility="Collapsed"
                              Click="ResumeAutoScroll_Click"/>
                <AppBarButton Icon="Find"
                              Label="Search"
                              Click="Search_Click"/>
                <AppBarButton Icon="List"
                              Label="Menu"
                              Click="CommandBarMenu_Click"/>
            </CommandBar.PrimaryCommands>

        </CommandBar>
    </Page.BottomAppBar>
</page:ConsolePageBase>